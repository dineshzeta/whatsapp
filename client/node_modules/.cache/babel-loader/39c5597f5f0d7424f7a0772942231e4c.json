{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Administrator/Desktop/Whatshub_v1.2/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/Administrator/Desktop/Whatshub_v1.2/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Administrator/Desktop/Whatshub_v1.2/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Box,Divider,Stack,Typography,Accordion,AccordionSummary,AccordionDetails,LinearProgress,TextField,IconButton}from'@mui/material';import axios from'axios';import React from'react';import moment from'moment';import{DoneAll,Send,Done,ExpandMore,Delete}from'@mui/icons-material';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PingFromUser=function PingFromUser(){var _React$useState=React.useState({}),_React$useState2=_slicedToArray(_React$useState,2),state=_React$useState2[0],setState=_React$useState2[1];var token=localStorage.getItem(process.env.REACT_APP_TOKEN+\"_admin\");function getMessages(){setState(_objectSpread(_objectSpread({},state),{},{loading:true}));axios.get(\"\".concat(process.env.REACT_APP_BASE_URL,\"/api/ping/get_all\"),{headers:{Authorization:\"Bearer \"+token}}).then(function(res){return setState(_objectSpread(_objectSpread({},state),{},{messages:res.data.data,loading:false,admin_response:\"\"}));}).catch(function(err){return console.log(err);});}React.useEffect(function(){if(!token){return;}getMessages();},[token]);function sendRes(e){setState(_objectSpread(_objectSpread({},state),{},{loading:true}));axios.post(\"\".concat(process.env.REACT_APP_BASE_URL,\"/api/ping/respond\"),{id:e,admin_response:state.admin_response},{headers:{Authorization:\"Bearer \"+token}}).then(function(res){alert(res.data.msg);if(!res.data.success){console.log(res.data);}setState(_objectSpread(_objectSpread({},state),{},{loading:false,admin_response:\"\"}));getMessages();}).catch(function(err){return console.log(err);});}function deleteMsg(e){if(window.confirm(\"Are your sure you want to delete this message?\")){setState(_objectSpread(_objectSpread({},state),{},{loading:true}));axios.post(\"\".concat(process.env.REACT_APP_BASE_URL,\"/api/ping/delete\"),{id:e},{headers:{Authorization:\"Bearer \"+token}}).then(function(res){alert(res.data.msg);if(!res.data.success){console.log(res.data);}setState(_objectSpread(_objectSpread({},state),{},{loading:false}));getMessages();}).catch(function(err){return console.log(err);});}}return/*#__PURE__*/_jsxs(Box,{p:2,children:[/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsx(Stack,{justifyContent:'space-between',alignItems:\"center\",direction:'row',spacing:2,children:/*#__PURE__*/_jsx(Typography,{fontWeight:'bold',children:\"Manage Pings\"})})}),/*#__PURE__*/_jsx(Box,{mt:2,mb:2,children:/*#__PURE__*/_jsx(Divider,{})}),/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsx(Stack,{direction:'column',spacing:2,children:state.messages?_toConsumableArray(state.messages).reverse().map(function(item,key){return/*#__PURE__*/_jsxs(Accordion,{children:[/*#__PURE__*/_jsx(AccordionSummary,{sx:{bgcolor:item.admin_response?\"green\":'black',borderRadius:2},expandIcon:/*#__PURE__*/_jsx(ExpandMore,{}),\"aria-controls\":\"panel1a-content\",id:\"panel1a-header\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",children:[key+1,\") \",item.message,\" \",item.admin_response?/*#__PURE__*/_jsx(DoneAll,{sx:{color:'lightgreen',height:15,width:15}}):/*#__PURE__*/_jsx(Done,{sx:{color:'lightgreen',height:15,width:15}})]})}),/*#__PURE__*/_jsx(AccordionDetails,{children:/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(Typography,{sx:{mb:2},fontSize:12,color:\"gray\",children:item.admin_response?item.admin_response:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TextField,{sx:{mt:1},value:state.admin_response,onChange:function onChange(e){return setState(_objectSpread(_objectSpread({},state),{},{admin_response:e.target.value}));},fullWidth:true,label:\"Enter your response\",size:\"small\",rows:4,multiline:true}),/*#__PURE__*/_jsx(Stack,{mt:2,direction:'row',justifyContent:'space-between',spacing:2,alignItems:\"center\",children:/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){return sendRes(item.id);},disabled:state.admin_response?false:true,children:/*#__PURE__*/_jsx(Send,{})})})]})}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(Stack,{mt:2,direction:'row',justifyContent:'space-between',spacing:2,alignItems:\"center\",children:[/*#__PURE__*/_jsxs(Typography,{sx:{mt:2},align:\"right\",fontSize:12,color:\"gray\",children:[\"Sent on: \",moment(item.createdAt).format('DD-MMMM-YYYY')]}),/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){return deleteMsg(item.id);},children:/*#__PURE__*/_jsx(Delete,{sx:{color:'red'}})})]})]})})]},key);}):/*#__PURE__*/_jsx(LinearProgress,{})})})]});};export default PingFromUser;","map":{"version":3,"names":["Box","Divider","Stack","Typography","Accordion","AccordionSummary","AccordionDetails","LinearProgress","TextField","IconButton","axios","React","moment","DoneAll","Send","Done","ExpandMore","Delete","PingFromUser","useState","state","setState","token","localStorage","getItem","process","env","REACT_APP_TOKEN","getMessages","loading","get","REACT_APP_BASE_URL","headers","Authorization","then","res","messages","data","admin_response","catch","err","console","log","useEffect","sendRes","e","post","id","alert","msg","success","deleteMsg","window","confirm","reverse","map","item","key","bgcolor","borderRadius","message","color","height","width","mb","mt","target","value","createdAt","format"],"sources":["C:/Users/Administrator/Desktop/Whatshub_v1.2/client/src/admin/pages/ping-user/PingFromUser.js"],"sourcesContent":["import { Box, Divider, Stack, Typography, Accordion, AccordionSummary, AccordionDetails, LinearProgress, TextField, IconButton } from '@mui/material'\r\nimport axios from 'axios'\r\nimport React from 'react'\r\nimport moment from 'moment'\r\nimport { DoneAll, Send, Done, ExpandMore, Delete } from '@mui/icons-material'\r\n\r\nconst PingFromUser = () => {\r\n    const [state, setState] = React.useState({})\r\n    const token = localStorage.getItem(process.env.REACT_APP_TOKEN + \"_admin\")\r\n\r\n    function getMessages() {\r\n        setState({ ...state, loading: true })\r\n        axios.get(`${process.env.REACT_APP_BASE_URL}/api/ping/get_all`, {\r\n            headers: {\r\n                Authorization: \"Bearer \" + token\r\n            }\r\n        }).then((res) => setState({ ...state, messages: res.data.data, loading: false, admin_response: \"\" }))\r\n            .catch((err) => console.log(err))\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        if (!token) {\r\n            return\r\n        }\r\n        getMessages()\r\n    }, [token])\r\n\r\n    function sendRes(e) {\r\n        setState({ ...state, loading: true })\r\n        axios.post(`${process.env.REACT_APP_BASE_URL}/api/ping/respond`, {\r\n            id: e,\r\n            admin_response: state.admin_response\r\n        }, {\r\n            headers: {\r\n                Authorization: \"Bearer \" + token\r\n            }\r\n        }).then((res) => {\r\n            alert(res.data.msg)\r\n            if (!res.data.success) {\r\n                console.log(res.data)\r\n            }\r\n            setState({ ...state, loading: false, admin_response: \"\" })\r\n            getMessages()\r\n        })\r\n            .catch((err) => console.log(err))\r\n    }\r\n\r\n    function deleteMsg(e) {\r\n        if (window.confirm(`Are your sure you want to delete this message?`)) {\r\n            setState({ ...state, loading: true })\r\n            axios.post(`${process.env.REACT_APP_BASE_URL}/api/ping/delete`, {\r\n                id: e\r\n            }, {\r\n                headers: {\r\n                    Authorization: \"Bearer \" + token\r\n                }\r\n            }).then((res) => {\r\n                alert(res.data.msg)\r\n                if (!res.data.success) {\r\n                    console.log(res.data)\r\n                }\r\n                setState({ ...state, loading: false })\r\n                getMessages()\r\n            })\r\n                .catch((err) => console.log(err))\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Box p={2} >\r\n\r\n            <Box>\r\n                <Stack justifyContent={'space-between'} alignItems='center' direction={'row'} spacing={2}>\r\n                    <Typography fontWeight={'bold'} >Manage Pings</Typography>\r\n                </Stack>\r\n            </Box>\r\n            <Box mt={2} mb={2}>\r\n                <Divider />\r\n            </Box>\r\n\r\n            <Box>\r\n                <Stack direction={'column'} spacing={2}>\r\n                    {\r\n                        state.messages ? [...state.messages].reverse().map((item, key) => {\r\n                            return (\r\n                                <Accordion key={key} >\r\n                                    <AccordionSummary\r\n                                        sx={{ bgcolor: item.admin_response ? \"green\" : 'black', borderRadius: 2 }}\r\n                                        expandIcon={<ExpandMore />}\r\n                                        aria-controls=\"panel1a-content\"\r\n                                        id=\"panel1a-header\"\r\n                                    >\r\n                                        <Typography variant='caption' >{key + 1}) {item.message} {item.admin_response ? <DoneAll sx={{ color: 'lightgreen', height: 15, width: 15 }} /> : <Done sx={{ color: 'lightgreen', height: 15, width: 15 }} />}</Typography>\r\n                                    </AccordionSummary>\r\n                                    <AccordionDetails>\r\n                                        <Typography>\r\n                                            <Typography sx={{ mb: 2 }} fontSize={12} color='gray' >{\r\n                                                item.admin_response ? (\r\n                                                    item.admin_response\r\n                                                ) : (\r\n                                                    <>\r\n                                                        <TextField sx={{ mt: 1 }} value={state.admin_response} onChange={(e) => setState({ ...state, admin_response: e.target.value })} fullWidth label=\"Enter your response\" size=\"small\" rows={4} multiline />\r\n                                                        <Stack mt={2} direction={'row'} justifyContent={'space-between'} spacing={2} alignItems='center'>\r\n                                                            <IconButton onClick={() => sendRes(item.id)} disabled={state.admin_response ? false : true} >\r\n                                                                <Send />\r\n                                                            </IconButton>\r\n                                                        </Stack>\r\n                                                    </>\r\n                                                )\r\n                                            }</Typography>\r\n                                            <Divider />\r\n                                            <Stack mt={2} direction={'row'} justifyContent={'space-between'} spacing={2} alignItems='center'>\r\n                                                <Typography sx={{ mt: 2 }} align='right' fontSize={12} color='gray' >Sent on: {moment(item.createdAt).format('DD-MMMM-YYYY')}</Typography>\r\n                                                <IconButton onClick={() => deleteMsg(item.id)} >\r\n                                                    <Delete sx={{ color: 'red' }} />\r\n                                                </IconButton>\r\n                                            </Stack>\r\n                                        </Typography>\r\n                                    </AccordionDetails>\r\n                                </Accordion>\r\n                            )\r\n                        }) : (\r\n                            <LinearProgress />\r\n                        )\r\n                    }\r\n                </Stack>\r\n            </Box>\r\n        </Box >\r\n    )\r\n}\r\n\r\nexport default PingFromUser"],"mappings":"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"},"metadata":{},"sourceType":"module"}