{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Administrator/Desktop/Whatshub_v1.2/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/Administrator/Desktop/Whatshub_v1.2/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Administrator/Desktop/Whatshub_v1.2/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{ChevronRight,ExpandMore,FileDownload}from'@mui/icons-material';import{LoadingButton,TreeItem,TreeView}from'@mui/lab';import{Box,Divider,Typography,Stack,Accordion,AccordionSummary,AccordionDetails,LinearProgress}from'@mui/material';import axios from'axios';import React from'react';import moment from'moment';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TransLog=function TransLog(){var _React$useState=React.useState(\"\"),_React$useState2=_slicedToArray(_React$useState,2),order=_React$useState2[0],setOrder=_React$useState2[1];var _React$useState3=React.useState({}),_React$useState4=_slicedToArray(_React$useState3,2),state=_React$useState4[0],setState=_React$useState4[1];var token=localStorage.getItem(process.env.REACT_APP_TOKEN+\"_admin\");function getOrder(){setState(_objectSpread(_objectSpread({},state),{},{loading:true}));axios.get(\"\".concat(process.env.REACT_APP_BASE_URL,\"/api/order/get_all_orders_admin\"),{headers:{Authorization:'Bearer '+token}}).then(function(res){setOrder(res.data.data);setState(_objectSpread(_objectSpread({},state),{},{loading:false}));}).catch(function(err){return console.log(err);});}React.useEffect(function(){if(!token){return;}getOrder();},[token]);function clearAll(e){if(window.confirm(\"Are your sure you want to delete all logs ?\")){setState(_objectSpread(_objectSpread({},state),{},{loading:true}));axios.get(\"\".concat(process.env.REACT_APP_BASE_URL,\"/api/order/clear_all_log\"),{headers:{Authorization:\"Bearer \"+token}}).then(function(res){setState(_objectSpread(_objectSpread({},state),{},{loading:false}));if(!res.data.success){console.log(res.data);}alert(res.data.msg);getOrder();}).catch(function(err){console.log(err);setState(_objectSpread(_objectSpread({},state),{},{loading:false}));});}}return/*#__PURE__*/_jsxs(Box,{p:2,children:[/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsxs(Stack,{justifyContent:'space-between',alignItems:\"center\",direction:'row',spacing:2,children:[/*#__PURE__*/_jsx(Typography,{fontWeight:'bold',children:\"Transaction Log(s)\"}),/*#__PURE__*/_jsx(Stack,{direction:'row',spacing:1,children:/*#__PURE__*/_jsx(LoadingButton,{loading:state.loading,onClick:clearAll,color:\"error\",variant:\"contained\",sx:{textTransform:'none'},children:\"Clear All\"})})]})}),/*#__PURE__*/_jsx(Box,{mt:2,mb:2,children:/*#__PURE__*/_jsx(Divider,{})}),/*#__PURE__*/_jsx(Stack,{direction:'column',spacing:2,children:order?_toConsumableArray(order).reverse().map(function(item,key){return/*#__PURE__*/_jsxs(Accordion,{children:[/*#__PURE__*/_jsx(AccordionSummary,{sx:{backgroundColor:'#1D5469',borderRadius:2},expandIcon:/*#__PURE__*/_jsx(ExpandMore,{}),children:/*#__PURE__*/_jsx(Typography,{children:item.order_type})}),/*#__PURE__*/_jsx(AccordionDetails,{children:/*#__PURE__*/_jsxs(Stack,{direction:'column',spacing:0.5,children:[/*#__PURE__*/_jsxs(Typography,{color:\"gray\",variant:\"caption\",children:[\"Buyer Email: \",JSON.parse(item.user_data).email]}),/*#__PURE__*/_jsxs(Typography,{color:\"gray\",variant:\"caption\",children:[\"Payment ID: \",JSON.parse(item.transaction).id]}),/*#__PURE__*/_jsxs(Typography,{color:\"gray\",variant:\"caption\",children:[\"Status: \",JSON.parse(item.transaction).status]}),item.order_type===\"Razorpay\"&&/*#__PURE__*/_jsxs(Typography,{color:\"gray\",variant:\"caption\",children:[\"Amount: \",JSON.parse(item.transaction).amount/100,\" \",JSON.parse(item.transaction).currency]}),item.order_type===\"Paypal\"&&/*#__PURE__*/_jsxs(Typography,{color:\"gray\",variant:\"caption\",children:[\"Amount: \",JSON.parse(item.transaction).gross_total_amount.value,\" \",JSON.parse(item.transaction).gross_total_amount.currency]}),/*#__PURE__*/_jsxs(Typography,{color:\"gray\",variant:\"caption\",children:[\"Caprure Date & Time: \",moment(item.createdAt).format('DD-MMMM-YYYY / h:mm:ss a')]})]})})]},key);}):/*#__PURE__*/_jsx(LinearProgress,{})})]});};export default TransLog;","map":{"version":3,"names":["ChevronRight","ExpandMore","FileDownload","LoadingButton","TreeItem","TreeView","Box","Divider","Typography","Stack","Accordion","AccordionSummary","AccordionDetails","LinearProgress","axios","React","moment","TransLog","useState","order","setOrder","state","setState","token","localStorage","getItem","process","env","REACT_APP_TOKEN","getOrder","loading","get","REACT_APP_BASE_URL","headers","Authorization","then","res","data","catch","err","console","log","useEffect","clearAll","e","window","confirm","success","alert","msg","textTransform","reverse","map","item","key","backgroundColor","borderRadius","order_type","JSON","parse","user_data","email","transaction","id","status","amount","currency","gross_total_amount","value","createdAt","format"],"sources":["C:/Users/Administrator/Desktop/Whatshub_v1.2/client/src/admin/pages/trans-log/TransLog.js"],"sourcesContent":["import { ChevronRight, ExpandMore, FileDownload } from '@mui/icons-material'\r\nimport { LoadingButton, TreeItem, TreeView } from '@mui/lab'\r\nimport { Box, Divider, Typography, Stack, Accordion, AccordionSummary, AccordionDetails, LinearProgress } from '@mui/material'\r\nimport axios from 'axios'\r\nimport React from 'react'\r\nimport moment from 'moment'\r\n\r\nconst TransLog = () => {\r\n    const [order, setOrder] = React.useState(\"\")\r\n    const [state, setState] = React.useState({})\r\n    const token = localStorage.getItem(process.env.REACT_APP_TOKEN + \"_admin\")\r\n\r\n    function getOrder() {\r\n        setState({ ...state, loading: true })\r\n        axios.get(`${process.env.REACT_APP_BASE_URL}/api/order/get_all_orders_admin`, {\r\n            headers: {\r\n                Authorization: 'Bearer ' + token\r\n            }\r\n        }).then((res) => {\r\n            setOrder(res.data.data)\r\n            setState({ ...state, loading: false })\r\n        }).catch((err) => console.log(err))\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        if (!token) {\r\n            return\r\n        }\r\n        getOrder()\r\n    }, [token])\r\n\r\n\r\n    function clearAll(e) {\r\n        if (window.confirm(`Are your sure you want to delete all logs ?`)) {\r\n            setState({ ...state, loading: true })\r\n            axios.get(`${process.env.REACT_APP_BASE_URL}/api/order/clear_all_log`, {\r\n                headers: {\r\n                    Authorization: \"Bearer \" + token\r\n                }\r\n            }).then((res) => {\r\n                setState({ ...state, loading: false })\r\n                if (!res.data.success) {\r\n                    console.log(res.data)\r\n                }\r\n                alert(res.data.msg)\r\n                getOrder()\r\n            }).catch((err) => {\r\n                console.log(err)\r\n                setState({ ...state, loading: false })\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n        <Box p={2} >\r\n            <Box>\r\n                <Stack justifyContent={'space-between'} alignItems='center' direction={'row'} spacing={2}>\r\n                    <Typography fontWeight={'bold'} >Transaction Log(s)</Typography>\r\n                    <Stack direction={'row'} spacing={1}>\r\n                        <LoadingButton loading={state.loading} onClick={clearAll} color='error' variant='contained' sx={{ textTransform: 'none' }} >Clear All</LoadingButton>\r\n                    </Stack>\r\n                </Stack>\r\n            </Box>\r\n            <Box mt={2} mb={2}>\r\n                <Divider />\r\n            </Box>\r\n\r\n            <Stack direction={'column'} spacing={2}>\r\n                {\r\n                    order ? (\r\n                        [...order].reverse().map((item, key) => {\r\n                            return (\r\n                                <Accordion key={key} >\r\n                                    <AccordionSummary\r\n                                        sx={{ backgroundColor: '#1D5469', borderRadius: 2 }}\r\n                                        expandIcon={<ExpandMore />}\r\n                                    >\r\n                                        <Typography>{item.order_type}</Typography>\r\n                                    </AccordionSummary>\r\n                                    <AccordionDetails>\r\n                                        <Stack direction={'column'} spacing={0.5} >\r\n                                            <Typography color='gray' variant='caption'>\r\n                                                Buyer Email: {JSON.parse(item.user_data).email}\r\n                                            </Typography>\r\n                                            <Typography color='gray' variant='caption'>\r\n                                                Payment ID: {JSON.parse(item.transaction).id}\r\n                                            </Typography>\r\n                                            <Typography color='gray' variant='caption'>\r\n                                                Status: {JSON.parse(item.transaction).status}\r\n                                            </Typography>\r\n                                            {\r\n                                                item.order_type === \"Razorpay\" && (\r\n                                                    <Typography color='gray' variant='caption'>\r\n                                                        Amount: {JSON.parse(item.transaction).amount / 100} {JSON.parse(item.transaction).currency}\r\n                                                    </Typography>\r\n                                                )\r\n                                            }\r\n                                            {\r\n                                                item.order_type === \"Paypal\" && (\r\n                                                    <Typography color='gray' variant='caption'>\r\n                                                        Amount: {JSON.parse(item.transaction).gross_total_amount.value} {JSON.parse(item.transaction).gross_total_amount.currency}\r\n                                                    </Typography>\r\n                                                )\r\n                                            }\r\n                                            <Typography color='gray' variant='caption'>\r\n                                                Caprure Date & Time: {moment(item.createdAt).format('DD-MMMM-YYYY / h:mm:ss a')}\r\n                                            </Typography>\r\n                                        </Stack>\r\n                                    </AccordionDetails>\r\n                                </Accordion>\r\n                            )\r\n                        })\r\n                    ) : <LinearProgress />\r\n                }\r\n            </Stack>\r\n\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default TransLog"],"mappings":"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"},"metadata":{},"sourceType":"module"}