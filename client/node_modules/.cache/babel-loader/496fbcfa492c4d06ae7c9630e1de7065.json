{"ast":null,"code":"import _objectSpread from\"C:/Users/Administrator/Desktop/Whatshub_v1.2/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Administrator/Desktop/Whatshub_v1.2/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{Box,Button,Chip,IconButton,InputAdornment,LinearProgress,Switch,Stack,Typography}from'@mui/material';import{SendBulkContext}from'../../../../context/SendBulkContext';import axios from'axios';import{AddPhotoAlternate,AttachFile,Warning}from'@mui/icons-material';import{LoadingButton}from'@mui/lab';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AddMediaComp=function AddMediaComp(props){var _React$useState=React.useState({}),_React$useState2=_slicedToArray(_React$useState,2),state=_React$useState2[0],setState=_React$useState2[1];var token=localStorage.getItem(process.env.REACT_APP_TOKEN+\"_user\");var _React$useState3=React.useState(0),_React$useState4=_slicedToArray(_React$useState3,2),uploadPer=_React$useState4[0],setUploadPer=_React$useState4[1];function uploadMedia(e){setState(_objectSpread(_objectSpread({},state),{},{loading:true}));e.preventDefault();var fd=new FormData();fd.append('file',state.file);axios.post(\"\".concat(process.env.REACT_APP_BASE_URL,\"/api/user/add_media\"),fd,{headers:{Authorization:\"Bearer \"+token},onUploadProgress:function onUploadProgress(e){setUploadPer(parseInt(Math.round(e.loaded*100/e.total)));}}).then(function(res){if(!res.data.success){alert(res.data.msg);}else{setState(_objectSpread(_objectSpread({},state),{},{loading:false}));setState(_objectSpread(_objectSpread({},state),{},{media_url:window.location.protocol+'//'+window.location.host+\"/user-media/\"+res.data.filename}));props.onComplete({media_url:window.location.protocol+'//'+window.location.host+\"/user-media/\"+res.data.filename});// sendBulk.setData({ ...state, media_url: window.location.protocol + '//' + window.location.host + \"/user-media/\" + res.data.filename })\n}});}return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Box,{borderRadius:2,bgcolor:\"#262626\",p:1,mt:2,mb:2,children:[/*#__PURE__*/_jsxs(Stack,{justifyContent:'space-between',direction:'row',alignItems:\"center\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"With Media ?\"}),/*#__PURE__*/_jsx(Switch,{onChange:function onChange(e){return setState(_objectSpread(_objectSpread({},state),{},{with_media:!state.with_media}));},checked:state.with_media})]}),state.with_media&&/*#__PURE__*/_jsx(Box,{mt:2,children:/*#__PURE__*/_jsxs(\"form\",{encType:\"formdata/multi-part\",onSubmit:uploadMedia,children:[/*#__PURE__*/_jsx(Stack,{mb:2,direction:'row',children:state.file||state.media_url?state.media_url?/*#__PURE__*/_jsx(Chip,{color:\"success\",label:state.media_url}):/*#__PURE__*/_jsx(Chip,{color:\"secondary\",onDelete:function onDelete(){setState(_objectSpread(_objectSpread({},state),{},{file:\"\"}));setUploadPer(0);},label:state.file.name}):/*#__PURE__*/_jsxs(Button,{startIcon:/*#__PURE__*/_jsx(AttachFile,{}),size:\"small\",component:\"label\",children:[/*#__PURE__*/_jsx(\"input\",{// accept=\"image/png, image/jpeg, image/jpg\"\ntype:\"file\",hidden:true,onChange:function onChange(e){if(e.target.files[0].size>15000000){return alert(\"Max accepted file is 15MB\");}setState(_objectSpread(_objectSpread({},state),{},{file:e.target.files[0]}));}}),\"Add Media\"]})}),uploadPer>0&&/*#__PURE__*/_jsx(LinearProgress,{color:uploadPer===100?'success':'primary',sx:{mb:2},variant:\"buffer\",value:uploadPer,valueBuffer:uploadPer+10}),state.file&&!state.media_url&&/*#__PURE__*/_jsx(LoadingButton,{loading:state.loading,fullWidth:true,disabled:state.media_url?true:false,color:state.media_url?'success':'secondary',size:\"small\",variant:\"contained\",type:\"submit\",children:state.media_url?\"Done\":\"Upload Media\"})]},1)})]})});};export default AddMediaComp;","map":{"version":3,"names":["React","Box","Button","Chip","IconButton","InputAdornment","LinearProgress","Switch","Stack","Typography","SendBulkContext","axios","AddPhotoAlternate","AttachFile","Warning","LoadingButton","AddMediaComp","props","useState","state","setState","token","localStorage","getItem","process","env","REACT_APP_TOKEN","uploadPer","setUploadPer","uploadMedia","e","loading","preventDefault","fd","FormData","append","file","post","REACT_APP_BASE_URL","headers","Authorization","onUploadProgress","parseInt","Math","round","loaded","total","then","res","data","success","alert","msg","media_url","window","location","protocol","host","filename","onComplete","with_media","name","target","files","size","mb"],"sources":["C:/Users/Administrator/Desktop/Whatshub_v1.2/client/src/user/pages/send-messages/components/AddMediaComp.js"],"sourcesContent":["import React from 'react'\r\nimport { Box, Button, Chip, IconButton, InputAdornment, LinearProgress, Switch, Stack, Typography } from '@mui/material'\r\nimport { SendBulkContext } from '../../../../context/SendBulkContext'\r\nimport axios from 'axios'\r\nimport { AddPhotoAlternate, AttachFile, Warning } from '@mui/icons-material'\r\nimport { LoadingButton } from '@mui/lab'\r\n\r\nconst AddMediaComp = (props) => {\r\n    const [state, setState] = React.useState({})\r\n    const token = localStorage.getItem(process.env.REACT_APP_TOKEN + \"_user\")\r\n    const [uploadPer, setUploadPer] = React.useState(0)\r\n\r\n    function uploadMedia(e) {\r\n        setState({ ...state, loading: true })\r\n        e.preventDefault()\r\n        let fd = new FormData()\r\n        fd.append('file', state.file)\r\n        axios.post(`${process.env.REACT_APP_BASE_URL}/api/user/add_media`, fd, {\r\n            headers: {\r\n                Authorization: \"Bearer \" + token\r\n            },\r\n            onUploadProgress: e => {\r\n                setUploadPer(parseInt(Math.round((e.loaded * 100) / e.total)))\r\n            }\r\n        }).then((res) => {\r\n            if (!res.data.success) {\r\n                alert(res.data.msg)\r\n            } else {\r\n                setState({ ...state, loading: false })\r\n                setState({ ...state, media_url: window.location.protocol + '//' + window.location.host + \"/user-media/\" + res.data.filename })\r\n                props.onComplete({ media_url: window.location.protocol + '//' + window.location.host + \"/user-media/\" + res.data.filename });\r\n                // sendBulk.setData({ ...state, media_url: window.location.protocol + '//' + window.location.host + \"/user-media/\" + res.data.filename })\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    return (\r\n        <div>\r\n\r\n            <Box borderRadius={2} bgcolor='#262626' p={1} mt={2} mb={2}>\r\n                <Stack justifyContent={'space-between'} direction={'row'} alignItems='center' >\r\n                    <Typography variant='caption'>With Media ?</Typography>\r\n                    <Switch\r\n\r\n                        onChange={(e) => setState({ ...state, with_media: !state.with_media })}\r\n                        checked={state.with_media} />\r\n                </Stack>\r\n\r\n                {\r\n                    state.with_media &&\r\n                    <Box mt={2} >\r\n                        <form key={1} encType='formdata/multi-part' onSubmit={uploadMedia} >\r\n                            {\r\n                                <Stack mb={2} direction={'row'}>\r\n\r\n                                    {\r\n                                        state.file || state.media_url ? (\r\n                                            state.media_url ? (\r\n                                                <Chip color='success' label={state.media_url} />\r\n                                            ) :\r\n                                                <Chip color='secondary' onDelete={() => {\r\n                                                    setState({ ...state, file: \"\" })\r\n                                                    setUploadPer(0)\r\n                                                }} label={state.file.name} />\r\n                                        ) : (\r\n                                            <Button startIcon={<AttachFile />} size='small' component=\"label\">\r\n                                                <input\r\n                                                    // accept=\"image/png, image/jpeg, image/jpg\"\r\n                                                    type=\"file\"\r\n                                                    hidden\r\n                                                    onChange={(e) => {\r\n                                                        if (e.target.files[0].size > 15000000) {\r\n                                                            return alert(\"Max accepted file is 15MB\")\r\n                                                        }\r\n                                                        setState({ ...state, file: e.target.files[0] })\r\n                                                    }}\r\n                                                />\r\n                                                Add Media\r\n                                            </Button>\r\n                                        )\r\n                                    }\r\n                                </Stack>\r\n                            }\r\n\r\n                            {uploadPer > 0 && <LinearProgress color={uploadPer === 100 ? 'success' : 'primary'} sx={{ mb: 2 }} variant=\"buffer\" value={uploadPer} valueBuffer={uploadPer + 10} />}\r\n\r\n                            {\r\n                                state.file && !state.media_url &&\r\n                                <LoadingButton\r\n                                    loading={state.loading}\r\n                                    fullWidth\r\n                                    disabled={state.media_url ? true : false}\r\n                                    color={state.media_url ? 'success' : 'secondary'}\r\n                                    size='small'\r\n                                    variant='contained' type=\"submit\" >\r\n                                    {state.media_url ? \"Done\" : \"Upload Media\"}\r\n                                </LoadingButton>\r\n                            }\r\n\r\n                        </form>\r\n                    </Box>\r\n                }\r\n            </Box>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AddMediaComp"],"mappings":"iRAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,OAASC,GAAG,CAAEC,MAAM,CAAEC,IAAI,CAAEC,UAAU,CAAEC,cAAc,CAAEC,cAAc,CAAEC,MAAM,CAAEC,KAAK,CAAEC,UAAU,KAAQ,eAAe,CACxH,OAASC,eAAe,KAAQ,qCAAqC,CACrE,MAAOC,MAAK,KAAM,OAAO,CACzB,OAASC,iBAAiB,CAAEC,UAAU,CAAEC,OAAO,KAAQ,qBAAqB,CAC5E,OAASC,aAAa,KAAQ,UAAU,yFAExC,GAAMC,aAAY,CAAG,QAAfA,aAAY,CAAIC,KAAK,CAAK,CAC5B,oBAA0BjB,KAAK,CAACkB,QAAQ,CAAC,CAAC,CAAC,CAAC,oDAArCC,KAAK,qBAAEC,QAAQ,qBACtB,GAAMC,MAAK,CAAGC,YAAY,CAACC,OAAO,CAACC,OAAO,CAACC,GAAG,CAACC,eAAe,CAAG,OAAO,CAAC,CACzE,qBAAkC1B,KAAK,CAACkB,QAAQ,CAAC,CAAC,CAAC,qDAA5CS,SAAS,qBAAEC,YAAY,qBAE9B,QAASC,YAAW,CAACC,CAAC,CAAE,CACpBV,QAAQ,gCAAMD,KAAK,MAAEY,OAAO,CAAE,IAAI,GAAG,CACrCD,CAAC,CAACE,cAAc,EAAE,CAClB,GAAIC,GAAE,CAAG,GAAIC,SAAQ,EAAE,CACvBD,EAAE,CAACE,MAAM,CAAC,MAAM,CAAEhB,KAAK,CAACiB,IAAI,CAAC,CAC7BzB,KAAK,CAAC0B,IAAI,WAAIb,OAAO,CAACC,GAAG,CAACa,kBAAkB,wBAAuBL,EAAE,CAAE,CACnEM,OAAO,CAAE,CACLC,aAAa,CAAE,SAAS,CAAGnB,KAC/B,CAAC,CACDoB,gBAAgB,CAAE,0BAAAX,CAAC,CAAI,CACnBF,YAAY,CAACc,QAAQ,CAACC,IAAI,CAACC,KAAK,CAAEd,CAAC,CAACe,MAAM,CAAG,GAAG,CAAIf,CAAC,CAACgB,KAAK,CAAC,CAAC,CAAC,CAClE,CACJ,CAAC,CAAC,CAACC,IAAI,CAAC,SAACC,GAAG,CAAK,CACb,GAAI,CAACA,GAAG,CAACC,IAAI,CAACC,OAAO,CAAE,CACnBC,KAAK,CAACH,GAAG,CAACC,IAAI,CAACG,GAAG,CAAC,CACvB,CAAC,IAAM,CACHhC,QAAQ,gCAAMD,KAAK,MAAEY,OAAO,CAAE,KAAK,GAAG,CACtCX,QAAQ,gCAAMD,KAAK,MAAEkC,SAAS,CAAEC,MAAM,CAACC,QAAQ,CAACC,QAAQ,CAAG,IAAI,CAAGF,MAAM,CAACC,QAAQ,CAACE,IAAI,CAAG,cAAc,CAAGT,GAAG,CAACC,IAAI,CAACS,QAAQ,GAAG,CAC9HzC,KAAK,CAAC0C,UAAU,CAAC,CAAEN,SAAS,CAAEC,MAAM,CAACC,QAAQ,CAACC,QAAQ,CAAG,IAAI,CAAGF,MAAM,CAACC,QAAQ,CAACE,IAAI,CAAG,cAAc,CAAGT,GAAG,CAACC,IAAI,CAACS,QAAS,CAAC,CAAC,CAC5H;AACJ,CACJ,CAAC,CAAC,CACN,CAGA,mBACI,kCAEI,MAAC,GAAG,EAAC,YAAY,CAAE,CAAE,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAE,CAAE,CAAC,EAAE,CAAE,CAAE,CAAC,EAAE,CAAE,CAAE,wBACvD,MAAC,KAAK,EAAC,cAAc,CAAE,eAAgB,CAAC,SAAS,CAAE,KAAM,CAAC,UAAU,CAAC,QAAQ,wBACzE,KAAC,UAAU,EAAC,OAAO,CAAC,SAAS,0BAA0B,cACvD,KAAC,MAAM,EAEH,QAAQ,CAAE,kBAAC5B,CAAC,QAAKV,SAAQ,gCAAMD,KAAK,MAAEyC,UAAU,CAAE,CAACzC,KAAK,CAACyC,UAAU,GAAG,EAAC,CACvE,OAAO,CAAEzC,KAAK,CAACyC,UAAW,EAAG,GAC7B,CAGJzC,KAAK,CAACyC,UAAU,eAChB,KAAC,GAAG,EAAC,EAAE,CAAE,CAAE,uBACP,cAAc,OAAO,CAAC,qBAAqB,CAAC,QAAQ,CAAE/B,WAAY,wBAE1D,KAAC,KAAK,EAAC,EAAE,CAAE,CAAE,CAAC,SAAS,CAAE,KAAM,UAGvBV,KAAK,CAACiB,IAAI,EAAIjB,KAAK,CAACkC,SAAS,CACzBlC,KAAK,CAACkC,SAAS,cACX,KAAC,IAAI,EAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAElC,KAAK,CAACkC,SAAU,EAAG,cAEhD,KAAC,IAAI,EAAC,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAE,mBAAM,CACpCjC,QAAQ,gCAAMD,KAAK,MAAEiB,IAAI,CAAE,EAAE,GAAG,CAChCR,YAAY,CAAC,CAAC,CAAC,CACnB,CAAE,CAAC,KAAK,CAAET,KAAK,CAACiB,IAAI,CAACyB,IAAK,EAAG,cAEjC,MAAC,MAAM,EAAC,SAAS,cAAE,KAAC,UAAU,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,OAAO,wBAC7D,cACI;AACA,IAAI,CAAC,MAAM,CACX,MAAM,MACN,QAAQ,CAAE,kBAAC/B,CAAC,CAAK,CACb,GAAIA,CAAC,CAACgC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAG,QAAQ,CAAE,CACnC,MAAOb,MAAK,CAAC,2BAA2B,CAAC,CAC7C,CACA/B,QAAQ,gCAAMD,KAAK,MAAEiB,IAAI,CAAEN,CAAC,CAACgC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,GAAG,CACnD,CAAE,EACJ,eAGT,EAED,CAGXpC,SAAS,CAAG,CAAC,eAAI,KAAC,cAAc,EAAC,KAAK,CAAEA,SAAS,GAAK,GAAG,CAAG,SAAS,CAAG,SAAU,CAAC,EAAE,CAAE,CAAEsC,EAAE,CAAE,CAAE,CAAE,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAEtC,SAAU,CAAC,WAAW,CAAEA,SAAS,CAAG,EAAG,EAAG,CAGjKR,KAAK,CAACiB,IAAI,EAAI,CAACjB,KAAK,CAACkC,SAAS,eAC9B,KAAC,aAAa,EACV,OAAO,CAAElC,KAAK,CAACY,OAAQ,CACvB,SAAS,MACT,QAAQ,CAAEZ,KAAK,CAACkC,SAAS,CAAG,IAAI,CAAG,KAAM,CACzC,KAAK,CAAElC,KAAK,CAACkC,SAAS,CAAG,SAAS,CAAG,WAAY,CACjD,IAAI,CAAC,OAAO,CACZ,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,UAChClC,KAAK,CAACkC,SAAS,CAAG,MAAM,CAAG,cAAc,EAC9B,GA7Cb,CAAC,CAgDL,EACL,GAER,EACJ,CAEd,CAAC,CAED,cAAerC,aAAY"},"metadata":{},"sourceType":"module"}