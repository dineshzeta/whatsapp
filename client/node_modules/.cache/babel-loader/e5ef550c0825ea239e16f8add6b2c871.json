{"ast":null,"code":"import _objectSpread from\"C:/Users/Administrator/Desktop/Whatshub_v1.2/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{Box,Button,Chip,Divider}from'@mui/material';import{Stack}from'@mui/system';import{Download,CloudUpload}from'@mui/icons-material';import React from'react';import{SendBulkContext}from'../../../../../context/SendBulkContext';import*as XLSX from'xlsx/xlsx.mjs';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ExcelNum=function ExcelNum(){var sendBulk=React.useContext(SendBulkContext);function handleChange(files){var file=files[0];var reader=new FileReader();reader.onload=function(e){var data=new Uint8Array(e.target.result);var workbook=XLSX.read(data,{type:'array'});// find the name of your sheet in the workbook first\nvar worksheet=workbook.Sheets['Sheet1'];// convert to json format\nvar jsonData=XLSX.utils.sheet_to_json(worksheet);sendBulk.setData(_objectSpread(_objectSpread({},sendBulk.data),{},{excel_array:jsonData}));jsonData.find(function(i){return typeof i.numbers!=='number'?[alert(\"Error found in numbers field\"),sendBulk.setData(_objectSpread(_objectSpread({},sendBulk.data),{},{excel_array:jsonData,chip_color:'error',file:file}))]:sendBulk.setData(_objectSpread(_objectSpread({},sendBulk.data),{},{excel_array:jsonData,chip_color:'success',file:file}));});};reader.readAsArrayBuffer(file);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Box,{p:5,border:0.5,borderRadius:2,children:/*#__PURE__*/_jsxs(Stack,{spacing:2,direction:'column',alignItems:\"center\",children:[sendBulk.data.file?/*#__PURE__*/_jsx(Chip,{color:sendBulk.data.chip_color,onDelete:function onDelete(){sendBulk.setData(_objectSpread(_objectSpread({},sendBulk.data),{},{file:\"\",excel_array:\"\"}));},label:sendBulk.data.file.name}):/*#__PURE__*/_jsxs(Button,{startIcon:/*#__PURE__*/_jsx(CloudUpload,{}),size:\"small\",component:\"label\",sx:{textTransform:'none'},variant:\"outlined\",children:[/*#__PURE__*/_jsx(\"input\",{accept:\".xlsx\",type:\"file\",hidden:true,onChange:function onChange(e){return handleChange(e.target.files);}}),\"Upload Excel  Sheet\"]}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){window.open('/whatsham-bulk-example.xlsx');},color:\"secondary\",startIcon:/*#__PURE__*/_jsx(Download,{}),style:{textTransform:'none'},size:\"small\",children:\"Download Excel Demo Sheet\"})]})}),/*#__PURE__*/_jsx(Box,{mb:2,mt:2,children:/*#__PURE__*/_jsx(Divider,{})}),/*#__PURE__*/_jsxs(Stack,{direction:'column',spacing:2,children:[/*#__PURE__*/_jsx(Button,{disabled:sendBulk.data.chip_color==='success'&&sendBulk.data.file?false:true,onClick:function onClick(){return sendBulk.setData(_objectSpread(_objectSpread({},sendBulk.data),{},{step:2}));},variant:\"contained\",size:\"small\",children:\"Next\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return sendBulk.setData(_objectSpread(_objectSpread({},sendBulk.data),{},{step:0}));},variant:\"outlined\",size:\"small\",children:\"Back\"})]})]});};export default ExcelNum;","map":{"version":3,"names":["Box","Button","Chip","Divider","Stack","Download","CloudUpload","React","SendBulkContext","XLSX","ExcelNum","sendBulk","useContext","handleChange","files","file","reader","FileReader","onload","e","data","Uint8Array","target","result","workbook","read","type","worksheet","Sheets","jsonData","utils","sheet_to_json","setData","excel_array","find","i","numbers","alert","chip_color","readAsArrayBuffer","name","textTransform","window","open","step"],"sources":["C:/Users/Administrator/Desktop/Whatshub_v1.2/client/src/user/pages/bulk-msg/components/excel/ExcelNum.js"],"sourcesContent":["import { Box, Button, Chip, Divider } from '@mui/material'\r\nimport { Stack } from '@mui/system'\r\nimport { Download, CloudUpload } from '@mui/icons-material'\r\nimport React from 'react'\r\nimport { SendBulkContext } from '../../../../../context/SendBulkContext'\r\nimport * as XLSX from 'xlsx/xlsx.mjs';\r\n\r\nconst ExcelNum = () => {\r\n    const sendBulk = React.useContext(SendBulkContext)\r\n\r\n    function handleChange(files) {\r\n        const file = files[0];\r\n        let reader = new FileReader();\r\n\r\n        reader.onload = function (e) {\r\n            let data = new Uint8Array(e.target.result);\r\n            let workbook = XLSX.read(data, { type: 'array' });\r\n            // find the name of your sheet in the workbook first\r\n            let worksheet = workbook.Sheets['Sheet1'];\r\n\r\n            // convert to json format\r\n            const jsonData = XLSX.utils.sheet_to_json(worksheet)\r\n            sendBulk.setData({ ...sendBulk.data, excel_array: jsonData })\r\n\r\n            jsonData.find(i => typeof i.numbers !== 'number' ?\r\n                [alert(\"Error found in numbers field\"), sendBulk.setData({ ...sendBulk.data, excel_array: jsonData, chip_color: 'error', file: file })] :\r\n                sendBulk.setData({ ...sendBulk.data, excel_array: jsonData, chip_color: 'success', file: file }))\r\n        };\r\n        reader.readAsArrayBuffer(file);\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Box p={5} border={0.5} borderRadius={2}>\r\n                <Stack spacing={2} direction={'column'} alignItems='center'>\r\n                    {\r\n                        sendBulk.data.file ? (\r\n                            <Chip\r\n                                color={sendBulk.data.chip_color}\r\n                                onDelete={() => {\r\n                                    sendBulk.setData({ ...sendBulk.data, file: \"\", excel_array: \"\" })\r\n                                }} label={sendBulk.data.file.name} />\r\n                        ) : (\r\n                            <Button\r\n                                startIcon={<CloudUpload />}\r\n                                size='small'\r\n                                component=\"label\"\r\n                                sx={{ textTransform: 'none' }}\r\n                                variant='outlined' >\r\n                                <input\r\n                                    accept=\".xlsx\"\r\n                                    type=\"file\"\r\n                                    hidden\r\n                                    onChange={(e) => handleChange(e.target.files)}\r\n                                />\r\n                                Upload Excel  Sheet\r\n                            </Button>\r\n                        )\r\n                    }\r\n\r\n                    <Button\r\n                        onClick={() => {\r\n                            window.open('/whatsham-bulk-example.xlsx')\r\n                        }}\r\n                        color='secondary'\r\n                        startIcon={<Download />}\r\n                        style={{ textTransform: 'none' }}\r\n                        size='small'>\r\n                        Download Excel Demo Sheet\r\n                    </Button>\r\n                </Stack>\r\n            </Box>\r\n\r\n            <Box mb={2} mt={2} >\r\n                <Divider />\r\n            </Box>\r\n\r\n            <Stack direction={'column'} spacing={2}>\r\n\r\n                <Button\r\n                    disabled={sendBulk.data.chip_color === 'success' && sendBulk.data.file ? false : true}\r\n                    onClick={() => sendBulk.setData({ ...sendBulk.data, step: 2 })}\r\n                    variant='contained'\r\n                    size='small'>Next</Button>\r\n\r\n                <Button\r\n                    onClick={() => sendBulk.setData({ ...sendBulk.data, step: 0 })}\r\n                    variant='outlined'\r\n                    size='small'>Back</Button>\r\n\r\n            </Stack>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ExcelNum"],"mappings":"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"},"metadata":{},"sourceType":"module"}